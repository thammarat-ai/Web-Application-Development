---
icon: '6'
---

# View Engines

จนถึงตอนนี้ คุณได้เรียนรู้วิธีการใช้ Node.js เพื่อเสิร์ฟไฟล์ ส่งกลับข้อมูล JSON และใช้งานเซิร์ฟเวอร์แชท ซึ่งเป็นการใช้งานทั่วไปของ Node.js ที่แสดงถึงความสามารถเฉพาะตัวของมัน นอกจากนี้ยังสามารถใช้ Node.js ในลักษณะคล้ายกับ PHP ได้ โดยใช้ JavaScript ใน Node.js เพื่อสร้าง HTML โดยใช้ view engine

วิธีการทำงานของ view engine ใน Node.js แสดงไว้ในรูปที่ 12 View engine ช่วยให้นักพัฒนาสามารถสร้างวิวโดยใช้รูปแบบพิเศษที่มีข้อมูลการนำเสนอและไฟล์ JavaScript ซึ่งคล้ายกับไฟล์ PHP ในแง่ที่ว่าพวกมันเป็นผลรวมของมาร์กอัปและโค้ด JavaScript โดยทั่วไปเรียกว่า เทมเพลตหรือวิว

<figure><img src="../.gitbook/assets/image (13).png" alt=""><figcaption><p>รูปที่ 12 View Engines and Node</p></figcaption></figure>

#### วิธีการทำงานของ View Engine:

1. **การสร้างเทมเพลต**: นักพัฒนาสามารถสร้างเทมเพลตที่มีทั้ง HTML และ JavaScript ซึ่งคล้ายกับไฟล์ PHP ที่ผสมระหว่างมาร์กอัปและโค้ด.
2. **การนำเสนอข้อมูล**: เทมเพลตเหล่านี้สามารถใช้เพื่อนำเสนอข้อมูลไดนามิกบนเว็บเพจ โดยใช้ข้อมูลที่ส่งมาจากเซิร์ฟเวอร์.
3. **การแสดงผล**: เมื่อเซิร์ฟเวอร์รับคำขอ มันจะใช้ view engine เพื่อแสดงผลข้อมูลที่ได้รับลงในเทมเพลตและส่งกลับไปยังไคลเอนต์เป็น HTML ที่สมบูรณ์.

สองวิวเอนจินที่ได้รับความนิยมมากที่สุดสำหรับ Node.js คือ **Pug** และ **Embedded JavaScript (EJS)**

#### Pug:

* **การกำหนดการนำเสนอ**: คุณกำหนดการนำเสนอของคุณในไฟล์ `.pug` ซึ่งไม่ใช้ HTML แต่ใช้ไวยากรณ์พิเศษของ Pug ซึ่งจะถูกแปลงเป็น HTML โดย Pug view engine ใน runtime.
* **ไวยากรณ์**: Pug ใช้การอินเดนต์เพื่อกำหนดการซ้อนของแท็ก ทำให้โค้ดมีความอ่านง่ายและง่ายต่อการบำรุงรักษา.

#### EJS:

* **การใช้ HTML**: EJS ใช้ HTML ปกติพร้อมกับ JavaScript ที่ฝังอยู่ภายในแท็ก `<% %>` ทำให้มีลักษณะคล้ายกับ PHP แต่ใช้ภาษา JavaScript แทน.
* **การผสมผสานโค้ด**: EJS ช่วยให้คุณสามารถผสมผสานมาร์กอัปและโค้ดโปรแกรมมิ่งได้ ซึ่งคล้ายกับ PHP แต่ใช้ JavaScript เป็นภาษาโปรแกรมมิ่ง.

#### การใช้งานกับ Express:

* **การติดตั้ง**: คุณต้องติดตั้งแพ็คเกจที่เหมาะสมโดยใช้ npm แล้วบอก Express ว่าควรใช้โฟลเดอร์ใดและวิวเอนจินใดในการแสดงไฟล์เหล่านั้น
*   **ตัวอย่างสำหรับ EJS**:

    ```javascript
    // บอก Express ให้ดูวิวในโฟลเดอร์ชื่อ 'views'
    app.set("views", path.join(__dirname, "views"));
    // บอก Express ว่าจะใช้วิวเอนจิน EJS
    app.set("view engine", "ejs");
    ```
*   **การใช้ฟังก์ชัน render()**: เพื่อใช้วิวใดๆ คุณใช้ฟังก์ชัน `render()` ของ Express:

    ```javascript
    app.get("/list/", function(req, res) {
      res.render("list.ejs", { title: "Sample", paintings: paintings });
    });
    ```

#### การใช้งาน Pug:

*   **การติดตั้ง**: ติดตั้ง Pug โดยใช้ npm:

    ```bash
    npm install pug --save
    ```
*   **การตั้งค่า Pug**:

    ```javascript
    app.set('view engine', 'pug');
    ```
* **การสร้างไฟล์ Pug**: สร้างไฟล์ `.pug` ในโฟลเดอร์ `views` เพื่อใช้แทน HTML.



```ejs
<!DOCTYPE html>
<html>
<head>
  <title><%= title %></title>
</head>
<body>
  <h1><%= title %></h1>
  <ul>
    <% paintings.forEach(function(painting) { %>
      <li><%= painting.title %> by <%= painting.artist %></li>
    <% }); %>
  </ul>
</body>
</html>
```

Listing 11 ตัวอย่าง EJS



คุณสามารถส่งข้อมูลใดๆ ไปยังวิวได้โดยใช้แถวที่สองของฟังก์ชัน `render()` ตัวอย่างใน Listing 11 แสดงวิว EJS ที่แสดงข้อมูลที่ส่งมาให้

สังเกตว่า JavaScript ใดๆ สามารถอยู่ภายในแท็ก `<% %>` และมีการเข้าถึงวัตถุทั้งหมดที่ส่งมาให้

#### การใช้งาน EJS:

1. **การแสดงข้อมูล**: ใช้แท็ก `<%= %>` เพื่อแสดงข้อมูลที่ส่งมาจากเซิร์ฟเวอร์ เช่น `title`, `p.filename`, `p.artist`, `p.title`, และ `p.year`.
2. **การวนซ้ำข้อมูล**: ใช้แท็ก `<% %>` เพื่อเขียนโค้ด JavaScript เช่น การวนซ้ำข้อมูลในอาร์เรย์ `paintings`.
3. **การเข้าถึงวัตถุ**: วัตถุที่ส่งมาจากเซิร์ฟเวอร์สามารถเข้าถึงได้ภายในแท็ก `<% %>` เช่น `paintings`.

